<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Numerical Differentiation — numerical_differentiation • boostmath</title><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Numerical Differentiation — numerical_differentiation"><meta name="description" content="Functions for numerical differentiation using finite difference and complex step methods.
Finite Difference Derivative:
Calculates a finite-difference approximation to the derivative of a function \(f\) at point \(x\).
This problem is ill-conditioned: truncation error (\(O(h^k)\)) decreases with \(h\), but roundoff error increases.
The function balances these errors automatically. The default order is 6.
Requires the function to be differentiable (up to the order requested).
Complex Step Derivative:
Computes the derivative of a real-valued function \(f(x)\) using the complex step approximation:
$$f'(x) \approx \frac{\Im(f(x + ih))}{h}$$
This method avoids the subtractive cancellation error inherent in finite differences and is extremely accurate.
However, it requires \(f\) to be a holomorphic function (complex-differentiable) that takes real values at real arguments.
Ideally, the function f should be able to accept a complex argument."><meta property="og:description" content="Functions for numerical differentiation using finite difference and complex step methods.
Finite Difference Derivative:
Calculates a finite-difference approximation to the derivative of a function \(f\) at point \(x\).
This problem is ill-conditioned: truncation error (\(O(h^k)\)) decreases with \(h\), but roundoff error increases.
The function balances these errors automatically. The default order is 6.
Requires the function to be differentiable (up to the order requested).
Complex Step Derivative:
Computes the derivative of a real-valued function \(f(x)\) using the complex step approximation:
$$f'(x) \approx \frac{\Im(f(x + ih))}{h}$$
This method avoids the subtractive cancellation error inherent in finite differences and is extremely accurate.
However, it requires \(f\) to be a holomorphic function (complex-differentiable) that takes real values at real arguments.
Ideally, the function f should be able to accept a complex argument."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">boostmath</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/constants.html">Boost Math - Constants</a></li>
    <li><a class="dropdown-item" href="../articles/filters.html">Boost Math - Filters</a></li>
    <li><a class="dropdown-item" href="../articles/fp_utilities.html">Boost Math - Floating Point Utilities</a></li>
    <li><a class="dropdown-item" href="../articles/interpolation.html">Boost Math - Interpolation</a></li>
    <li><a class="dropdown-item" href="../articles/quadrature-differentiation.html">Boost Math - Quadrature and Differentiation</a></li>
    <li><a class="dropdown-item" href="../articles/rootfinding-minimisation.html">Boost Math - Root Finding and Minimisation Algorithms</a></li>
    <li><a class="dropdown-item" href="../articles/special-functions.html">Boost Math - Special Functions</a></li>
    <li><a class="dropdown-item" href="../articles/statistical-distributions.html">Boost Math - Statistical Distributions</a></li>
    <li><a class="dropdown-item" href="../articles/statistics.html">Boost Math - Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/vector-functionals.html">Boost Math - Vector Functionals</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/andrjohns/boostmath/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Numerical Differentiation</h1>
      <small class="dont-index">Source: <a href="https://github.com/andrjohns/boostmath/blob/main/R/quadrature_and_differentiation.R" class="external-link"><code>R/quadrature_and_differentiation.R</code></a></small>
      <div class="d-none name"><code>numerical_differentiation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Functions for numerical differentiation using finite difference and complex step methods.</p>
<p><strong>Finite Difference Derivative:</strong>
Calculates a finite-difference approximation to the derivative of a function \(f\) at point \(x\).
This problem is ill-conditioned: truncation error (\(O(h^k)\)) decreases with \(h\), but roundoff error increases.
The function balances these errors automatically. The default order is 6.
Requires the function to be differentiable (up to the order requested).</p>
<p><strong>Complex Step Derivative:</strong>
Computes the derivative of a real-valued function \(f(x)\) using the complex step approximation:
$$f'(x) \approx \frac{\Im(f(x + ih))}{h}$$
This method avoids the subtractive cancellation error inherent in finite differences and is extremely accurate.
However, it requires \(f\) to be a holomorphic function (complex-differentiable) that takes real values at real arguments.
Ideally, the function <code>f</code> should be able to accept a complex argument.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">finite_difference_derivative</span><span class="op">(</span><span class="va">f</span>, <span class="va">x</span>, order <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">complex_step_derivative</span><span class="op">(</span><span class="va">f</span>, <span class="va">x</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-f">f<a class="anchor" aria-label="anchor" href="#arg-f"></a></dt>
<dd><p>A function to differentiate. It should accept a single numeric/complex value and return a single numeric/complex value.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>The point at which to evaluate the derivative.</p></dd>


<dt id="arg-order">order<a class="anchor" aria-label="anchor" href="#arg-order"></a></dt>
<dd><p>The order of accuracy of the finite difference method. Can be 1, 2, 4, 6, or 8. Default is 1.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The approximate value of the derivative at the point <code>x</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="numerical_integration.html">numerical_integration</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Finite difference derivative of sin(x) at pi/4</span></span></span>
<span class="r-in"><span><span class="fu">finite_difference_derivative</span><span class="op">(</span><span class="va">sin</span>, <span class="va">pi</span> <span class="op">/</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7071068</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Complex step derivative of exp(x) at 1.7 (Requires f to handle complex input ideally)</span></span></span>
<span class="r-in"><span><span class="co"># Note: In pure R, `exp` handles complex numbers automatically.</span></span></span>
<span class="r-in"><span><span class="fu">complex_step_derivative</span><span class="op">(</span><span class="va">exp</span>, <span class="fl">1.7</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.473947</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew R. Johnson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

